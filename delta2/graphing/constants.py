ACCOUNT_SECURITY = {'1':"SCRIPT",'2':"ACCOUNTDISABLE",'8':"HOMEDIR_REQUIRED",'16':"LOCKOUT",'32':"PASSWORD NOT REQUIRED (DANGEROUS)",'64':"PASSWD_CANT_CHANGE"
                                    ,'128':'ENCRYPTED_TEXT_PWD_ALLOWED','256':'TEMP_DUPLICATE_ACCOUNT (RISK)','512':'NORMAL_ACCOUNT','2048':'INTERNAL DOMAIN_TRUST ACCOUNT (RISK)',
                                    '4096':'WORKSTATION_TRUST_ACCOUNT','8192':'SERVER_TRUST_ACCOUNT','65536':'DONT_EXPIRE_PASSWORD (DANGEROUS)','131072':'MNS_LOGON_ACCOUNT',
                                    '262144':'SMARTCARD_REQUIRED (RISK)','524288':'TRUSTED_FOR_DELEGATION (DANGEROUS)','1048576':'NOT_DELEGATED','2097152':'USE_DES_KEY_ONLY',
                                    '4194304':'DONT_REQ_PREAUTH_(AS-REP roastable)','8388608':'PASSWORD_EXPIRED','67108864':'TRUSTED_TO_AUTH_FOR_DELEGATION (DCSync, DANGEROUS)','66048':"Enabled, Password Doesn't Expire (RISK)",
                                    '514':"Disabled Account", '66082':"Disabled, Password Doesn't Expire & Not Required",'532480':'Domain controller','4260352':"Enabled - Password Does Not Expire - PreAuthorization Not Required (AS-REP roastable)",
                                    "66080":"Disabled, Password Doesnâ€™t Expire & Not Required",'546':'Disabled, Password Not Required', '1114624': "Read Data/List Directory and Write Data/Add File" }
sAMAccountTYPE_NUMBERS = {
    805306368: "DS_RESERVED",
    805306369: "DS_USER_NORMAL",
    805306370: "DS_GROUP_NORMAL",
    805306372: "DS_COMPUTER_NORMAL",
    805306373: "DS_PRINTER_NORMAL",
    805306374: "DS_OU_NORMAL",
    805306376: "DS_USER_TRUST_ACCOUNT",
    805306377: "DS_GROUP_TRUST_ACCOUNT",
    805306378: "DS_COMPUTER_TRUST_ACCOUNT",
    805306380: "DS_NOT_SUPPORTED",
    805306381: "DS_SERVICE_NORMAL",
    805306382: "DS_SERVICE_TRUST_ACCOUNT",
    805306383: "DS_NTDSCRIPT",
    805306384: "DS_DS_ID_NOT_FOUND",
    805306385: "DS_GROUP_UNIVERSAL",
    805306386: "DS_BUILTIN_GROUP",
    805306387: "DS_ACCOUNT_TYPE_MAX",
    805306388: "DS_DNS_DOMAIN",
    805306389: "DS_NT_PRINCIPAL_NAME",
    805306391: "DS_NT_AUTHORITY",
    805306392: "DS_DMD",
    805306393: "DS_ROOT_TRUST",
    805306394: "DS_ROOT_NAME",
    805306395: "DS_NETBIOS_NAME",
    805306396: "DS_POLICY_TRUST",
    805306397: "DS_REPLICA_SOURCE",
    805306398: "DS_REPLICA_DESTINATION",
    805306399: "DS_DOMAIN_NAME",
    805306400: "DS_USER_REP",
    805306401: "DS_GROUP_REP",
    805306402: "DS_GROUP_IN_DCL",
    805306403: "DS_GROUP_NORMAL_IN_DCL",
    805306404: "DS_GROUP_IN_LCL",
    805306405: "DS_GROUP_NORMAL_IN_LCL",
    805306406: "DS_ADMINISTRATORS",
    805306407: "DS_GROUP_MIGRATION",
    805306408: "DS_FOREST_TRUST",
    805306409: "DS_IPSEC_ENDSYSTEM",
    805306410: "DS_IPSEC_TUNNEL",
    805306411: "DS_IPSEC_USER",
    805306412: "DS_RIGHTS_MGMT",
    805306413: "DS_RID_SETS",
    805306414: "DS_CAP_ACTIVE_DIRECTORY_DS",
}


IMPORTANT_EXTENDED_RIGHTS = [
    "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2",
    "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2",
    "89e95b76-444d-4c62-991a-0facbeda640c",
    "bf9679c0-0de6-11d0-a285-00aa003049e2",
    "00299570-246d-11d0-a768-00aa006e0529",
    "3f78c3e5-f79a-46bd-a0b8-9d18116ddc79",
    "4c164200-20c0-11d0-a768-00aa006e0529"]

ACE_TYPES = {
    "A": "ACCESS ALLOWED",
    "D": "ACCESS DENIED",
    "OA": "OBJECT ACCESS ALLOWED",
    "OD": "OBJECT ACCESS DENIED",
    "AU": "SYSTEM AUDIT",
    "AL": "SYSTEM ALARM",
    "OU": "OBJECT SYSTEM AUDIT",
    "OL": "OBJECT SYSTEM ALARM",
    "P": 'Propagate to child objects',
    "I": "Inherit only",
    "O": "Object inherit"

}
ACE_FLAGS = {
    "CI": "CONTAINER INHERIT",
    "OI": "OBJECT INHERIT",
    "NP": "NO PROPAGATE",
    "IO": "INHERITANCE ONLY",
    "ID": "ACE IS INHERITED",
    "SA": "SUCCESSFUL ACCESS AUDIT",
    "FA": "FAILED ACCESS AUDIT"
}

WELLKNOWN_SIDS = { # from https://github.com/dirkjanm/BloodHound.py/blob/5053e3f161757544d7f4b836033cbb31e6e555cb/bloodhound/ad/utils.py#L37
        "S-1-0": ("Null Authority", "USER"),
        "S-1-0-0": ("Nobody", "USER"),
        "S-1-1": ("World Authority", "USER"),
        "S-1-1-0": ("Everyone", "GROUP"),
        "S-1-2": ("Local Authority", "USER"),
        "S-1-2-0": ("Local", "GROUP"),
        "S-1-2-1": ("Console Logon", "GROUP"),
        "S-1-3": ("Creator Authority", "USER"),
        "S-1-3-0": ("Creator Owner", "USER"),
        "S-1-3-1": ("Creator Group", "GROUP"),
        "S-1-3-2": ("Creator Owner Server", "COMPUTER"),
        "S-1-3-3": ("Creator Group Server", "COMPUTER"),
        "S-1-3-4": ("Owner Rights", "GROUP"),
        "S-1-4": ("Non-unique Authority", "USER"),
        "S-1-5": ("NT Authority", "USER"),
        "S-1-5-1": ("Dialup", "GROUP"),
        "S-1-5-2": ("Network", "GROUP"),
        "S-1-5-3": ("Batch", "GROUP"),
        "S-1-5-4": ("Interactive", "GROUP"),
        "S-1-5-6": ("Service", "GROUP"),
        "S-1-5-7": ("Anonymous", "GROUP"),
        "S-1-5-8": ("Proxy", "GROUP"),
        "S-1-5-9": ("Enterprise Domain Controllers", "GROUP"),
        "S-1-5-10": ("Principal Self", "USER"),
        "S-1-5-11": ("Authenticated Users", "GROUP"),
        "S-1-5-12": ("Restricted Code", "GROUP"),
        "S-1-5-13": ("Terminal Server Users", "GROUP"),
        "S-1-5-14": ("Remote Interactive Logon", "GROUP"),
        "S-1-5-15": ("This Organization", "GROUP"),
        "S-1-5-17": ("IUSR", "USER"),
        "S-1-5-18": ("Local System", "USER"),
        "S-1-5-19": ("NT Authority", "USER"),
        "S-1-5-20": ("Network Service", "USER"),
        "S-1-5-80-0": ("All Services ", "GROUP"),
        "S-1-5-32-544": ("Administrators", "GROUP"),
        "S-1-5-32-545": ("Users", "GROUP"),
        "S-1-5-32-546": ("Guests", "GROUP"),
        "S-1-5-32-547": ("Power Users", "GROUP"),
        "S-1-5-32-548": ("Account Operators", "GROUP"),
        "S-1-5-32-549": ("Server Operators", "GROUP"),
        "S-1-5-32-550": ("Print Operators", "GROUP"),
        "S-1-5-32-551": ("Backup Operators", "GROUP"),
        "S-1-5-32-552": ("Replicators", "GROUP"),
        "S-1-5-32-554": ("Pre-Windows 2000 Compatible Access", "GROUP"),
        "S-1-5-32-555": ("Remote Desktop Users", "GROUP"),
        "S-1-5-32-556": ("Network Configuration Operators", "GROUP"),
        "S-1-5-32-557": ("Incoming Forest Trust Builders", "GROUP"),
        "S-1-5-32-558": ("Performance Monitor Users", "GROUP"),
        "S-1-5-32-559": ("Performance Log Users", "GROUP"),
        "S-1-5-32-560": ("Windows Authorization Access Group", "GROUP"),
        "S-1-5-32-561": ("Terminal Server License Servers", "GROUP"),
        "S-1-5-32-562": ("Distributed COM Users", "GROUP"),
        "S-1-5-32-568": ("IIS_IUSRS", "GROUP"),
        "S-1-5-32-569": ("Cryptographic Operators", "GROUP"),
        "S-1-5-32-573": ("Event Log Readers", "GROUP"),
        "S-1-5-32-574": ("Certificate Service DCOM Access", "GROUP"),
        "S-1-5-32-575": ("RDS Remote Access Servers", "GROUP"),
        "S-1-5-32-576": ("RDS Endpoint Servers", "GROUP"),
        "S-1-5-32-577": ("RDS Management Servers", "GROUP"),
        "S-1-5-32-578": ("Hyper-V Administrators", "GROUP"),
        "S-1-5-32-579": ("Access Control Assistance Operators", "GROUP"),
        "S-1-5-32-580": ("Access Control Assistance Operators", "GROUP"),
        "S-1-5-32-582": ("Storage Replica Administrators", "GROUP")
    }



HEX_PERMISSIONS = {
    0x10000000: "SET_GENERIC_ALL",
    0x04000000: "SET_GENERIC_WRITE",
    0x20000000: "SET_GENERIC_EXECUTE",
    0x80000000: "SET_GENERIC_READ",
    0x00020094: "GENERIC_READ",
    0x00020028: "GENERIC_WRITE",
    0x00020004: "GENERIC_EXECUTE",
    0x000F01FF: "GENERIC_ALL",
    0x02000000: "MAXIMUM_ALLOWED",
    0x01000000: "ACCESS_SYSTEM_SECURITY",
    0x00100000: "SYNCHRONIZE",
    0x00080000: "WRITE_OWNER",
    0x00040000: "WRITE_DACL",
    0x00020000: "READ_CONTROL",
    0x00010000: "DELETE",
    0x00000100: "ADS_RIGHT_DS_CONTROL_ACCESS",
    0x00000001: "ADS_RIGHT_DS_CREATE_CHILD",
    0x00000002: "ADS_RIGHT_DS_DELETE_CHILD",
    0x00000010: "ADS_RIGHT_DS_READ_PROP",
    0x00000020: "ADS_RIGHT_DS_WRITE_PROP",
    0x00000008: "ADS_RIGHT_DS_SELF",
    0x100000000: "Read GMSA Password"

}

permission_ranking = {
    "GENERIC_ALL": 100,
    "FILE_ALL_ACCESS": 95,
    "GENERIC_READ": 90,
    "FILE_GENERIC_READ": 85,
    "KEY_ALL_ACCESS": 80,
    "GENERIC_WRITE": 80,
    "FILE_GENERIC_WRITE": 75,
    "GENERIC_EXECUTE": 70,
    "FILE_GENERIC_EXECUTE": 65,
    "READ_PERMISSIONS": 60,
    "DELETE": 55,
    "MODIFY_PERMISSIONS": 50,
    "MODIFY_OWNER": 45,
    "READ_ALL_PROPERTIES": 40,
    "WRITE_ALL_PROPERTIES": 35,
    "CREATE_ALL_CHILD_OBJECTS": 30,
    "DELETE_ALL_CHILD_OBJECTS": 25,
    "LIST_CONTENTS": 20,
    "ALL_VALIDATED_WRITES": 15,
    "LIST_OBJECT": 10,
    "DELETE_SUBTREE": 5,
    "ALL_EXTENDED_RIGHTS": 1,
    "KEY_EXECUTE": 90,
    "KEY_READ": 85,
    "KEY_WRITE": 80,
    "KEY_CREATE_SUB_KEYS": 75,
    "KEY_QUERY_VALUE": 70,
    "KEY_SET_VALUE": 65,
    "KEY_ENUMERATE_SUB_KEYS": 60,
    "KEY_NOTIFY": 55,
    "SET_GENERIC_ALL": 100,
    "SET_GENERIC_WRITE": 95,
    "SET_GENERIC_EXECUTE": 90,
    "SET_GENERIC_READ": 85,
    "ADS_RIGHT_DS_CONTROL_ACCESS": 55,
    "ADS_RIGHT_DS_CREATE_CHILD": 55,
    "ADS_RIGHT_DS_DELETE_CHILD": 55,
    "ADS_RIGHT_DS_READ_PROP": 55,
    "ADS_RIGHT_DS_WRITE_PROP": 55,
    "ADS_RIGHT_DS_SELF": 55,
    "READ_CONTROL": 55,
    "WRITE_OWNER": 50,
    "WRITE_DACL": 45

}

EXTENED_RIGHTS = {
    "68b1d179-0d15-4d4f-ab71-46152e79a7bc": "Allowed_To_Authenticate",
    "ab721a56-1e2f-11d0-9819-00aa0040529b": "Receive_As",
    "ab721a54-1e2f-11d0-9819-00aa0040529b": "Send_As",
    "ab721a53-1e2f-11d0-9819-00aa0040529b": "User_Change_Password",
    "00299570-246d-11d0-a768-00aa006e0529": "User_Force_Change_Password",
    "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Get_Changes",
    "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Get_Changes_All",
    "1131f6ac-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Manage_Topology",
    "f98340fb-7c5b-4cdb-a00b-2ebdfa115a96": "DS_Replication_Monitor_Topology",
    "1131f6ab-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Synchronize",
    "b7b1b3de-ab09-4242-9e30-9980e5d322f7": "Generate_RSoP_Logging",
    "b7b1b3dd-ab09-4242-9e30-9980e5d322f7": "Generate_RSoP_Planning",
    "45ec5156-db7e-47bb-b53f-dbeb2d03c40f": "Reanimate_Tombstones",
    "014bf69c-7b3b-11d1-85f6-08002be74fab": "Change_Domain_Master",
    "2f16c4a5-b98e-432c-952a-cb388ba33f2e": "DS_Execute_Intentions_Script",
    "e12b56b6-0a95-11d1-adbb-00c04fd8d5cd": "Change_Schema_Master",
    "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Get_Changes",
    "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Get_Changes_All",
    "1131f6ac-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Manage_Topology",
    "f98340fb-7c5b-4cdb-a00b-2ebdfa115a96": "DS_Replication_Monitor_Topology",
    "1131f6ab-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Synchronize",
    "b7b1b3de-ab09-4242-9e30-9980e5d322f7": "Generate_RSoP_Logging",
    "45ec5156-db7e-47bb-b53f-dbeb2d03c40f": "Reanimate_Tombstones",
    "be2bb760-7f46-11d2-b9ad-00c04f79f805": "Update_Schema_Cache",
    "440820ad-65b4-11d1-a3da-0000f875ae0d": "Add_GUID",
    "bae50096-4752-11d1-9052-00c04fc2d4cf": "Change_PDC",
    "e2a36dc9-ae17-47c3-b58b-be34c55ba633": "Create_Inbound_Forest_Trust",
    "9923a32a-3607-11d2-b9be-0000f87a36b2": "DS_Install_Replica",
    "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Get_Changes",
    "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Get_Changes_All",
    "1131f6ac-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Manage_Topology",
    "f98340fb-7c5b-4cdb-a00b-2ebdfa115a96": "DS-Replication_Monitor_Topology",
    "1131f6ab-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Synchronize",
    "05c74c5e-4deb-43b4-bd9f-86664c2a7fd5": "Enable_Per_User_Reversibly_Encrypted_Password",
    "b7b1b3de-ab09-4242-9e30-9980e5d322f7": "Generate_RSoP_Logging",
    "b7b1b3dd-ab09-4242-9e30-9980e5d322f7": "Generate_RSoP_Planning",
    "ba33815a-4f93-4c76-87f3-57574bff8109": "Migrate-SID-History",
    "45ec5156-db7e-47bb-b53f-dbeb2d03c40f": "Reanimate_Tombstones",
    "ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501": "Unexpire_Password",
    "280f369c-67c7-438e-ae98-1d46f3c6f541":"Update_Password_Not_Required_Bit",
    "ab721a55-1e2f-11d0-9819-00aa0040529b": "Send_To",
    "edacfd8f-ffb3-11d1-b41d-00a0c968f939": "Apply_Group_Policy",
    "68b1d179-0d15-4d4f-ab71-46152e79a7bc": "Allowed_To_Authenticate",
    "ab721a56-1e2f-11d0-9819-00aa0040529b": "Receive_As",
    "ab721a54-1e2f-11d0-9819-00aa0040529b": "Send_As",
    "ab721a53-1e2f-11d0-9819-00aa0040529b": "User_Change_Password",
    "00299570-246d-11d0-a768-00aa006e0529": "User_Force_Change_Password",
    "cc749b82-47c9-4ab0-9014-167db06f82a5": "Change_Infrastructure_Master",
    "ab721a52-1e2f-11d0-9819-00aa0040529b": "Domain_Administer_Server",
    "4ecc03fe-ffc0-4947-b630-eb672a8a9dbc": "DS_Query_Self_Quota",
    "4b6e08c3-df3c-11d1-9c86-006008764d0e": "msmq_Peek_computer_Journal",
    "4b6e08c1-df3c-11d1-9c86-006008764d0e": "msmq_Peek_Dead_Letter",
    "4b6e08c2-df3c-11d1-9c86-006008764d0e": "msmq_Receive_computer_Journal",
    "4b6e08c0-df3c-11d1-9c86-006008764d0e": "msmq_Receive_Dead_Letter",
    "06bd3201-df3e-11d1-9c86-006008764d0e": "msmq_Peek",
    "06bd3200-df3e-11d1-9c86-006008764d0e": "msmq_Receive",
    "06bd3203-df3e-11d1-9c86-006008764d0e": "msmq_Receive_journal",
    "06bd3202-df3e-11d1-9c86-006008764d0e": "msmq_Send",
    "ee914b82-0a98-11d1-adbb-00c04fd8d5cd": "Abandon_Replication",
    "1abd7cf8-0a99-11d1-adbb-00c04fd8d5cd": "Allocate_Rids",
    "fec364e0-0a98-11d1-adbb-00c04fd8d5cd": "Do_Garbage_Collection",
    "69ae6200-7f46-11d2-b9ad-00c04f79f805": "DS_Check_Stale_Phantoms",
    "0bc1554e-0a99-11d1-adbb-00c04fd8d5cd": "Recalculate_Hierarchy",
    "62dd28a8-7f46-11d2-b9ad-00c04f79f805": "Recalculate_Security_Inheritance",
    "9432c620-033c-4db7-8b58-14ef6d0bf477": "Refresh_Group_Cache",
    "05c74c5e-4deb-43b4-bd9f-86664c2a7fd5": "Enable_Per_User_Reversibly_Encrypted_Password",
    "0e10c968-78fb-11d2-90d4-00c04f79dc55": "Certificate_Enrollment",
    "d58d5f36-0a98-11d1-adbb-00c04fd8d5cd": "Change_Rid_Master",
    "91d67418-0135-4acc-8d79-c08e857cfbec": "SAM_Enumerate_Entire_Domain",
    "b4e60130-df3f-11d1-9c86-006008764d0e": "msmq_Open_Connector",
    "68b1d179-0d15-4d4f-ab71-46152e79a7bc": "Allowed_To_Authenticate",
    "ab721a56-1e2f-11d0-9819-00aa0040529b": "Receive_As",
    "ab721a54-1e2f-11d0-9819-00aa0040529b": "Send_As",
    "ab721a53-1e2f-11d0-9819-00aa0040529b": "User_Change_Password",
    "00299570-246d-11d0-a768-00aa006e0529": "User_Force_Change_Password",
    "bf967a7f-0de6-11d0-a285-00aa003049e2": "Force_Logoff",
    "b7c69e6d-2cc7-11d2-854e-00a0c983f608": "Trusted_for_Delegation_Kerberos",
    "bf967a86-0de6-11d0-a285-00aa003049e2": "All",
    "e45795b3-9455-11d1-aebd-0000f80367c1": "Change_Domain_Master",
    "5b47d60f-6090-40b2-9f37-2a4de88f3063": "Unexpire_Password",
    "e45795b2-9455-11d1-aebd-0000f80367c1": "Change_Infrastructure_Master",
    "bf967950-0de6-11d0-a285-00aa003049e2": "Read_Only_Replication_Secret_Synchronization",
    "bf967a9c-0de6-11d0-a285-00aa003049e2": "Write",
    "5805bc62-bdc9-4428-a5e2-856a0f4c185e": "DS_Replication_Get_Changes_All",
    "4828cc14-1437-45bc-9b07-ad6f015e5f28": "Object_Inherit",
    "bf967953-0de6-11d0-a285-00aa003049e2": "Create_All_Child_Objects",
    "bc0ac240-79a9-11d0-9020-00c04fc2d4cf": "Read",
    "bf967aba-0de6-11d0-a285-00aa003049e2": "All_Object_Rights",
    "72e39547-7b18-11d1-adef-00c04fd8d5cd": "Validated_Write_to_DNS_Host_Name",
    "46a9b11d-60ae-405a-b7e8-ff8a58d456d2": "DS_Replication_Get_Changes",
    "77b5b886-944a-11d1-aebd-0000f80367c1": "DS_Replication_Get_Changes_In_Filtered_Set",
    "ea1b7b93-5e48-46d5-bc6c-4df4fda78a35": "DS_Replication_Get_Changes_All_with_a_Filter",
    "5f202010-79a5-11d0-9020-00c04fc2d4cf": "Extended_Right_for_New_Installation",
    "4c164200-20c0-11d0-a768-00aa006e0529": "Write_Owner",
    "91e647de-d96f-4b70-9557-d63ff4f3ccd8": "Force_Change_Password",
    "59ba2f42-79a2-11d0-9020-00c04fc2d3cf": "Validated_Write_to_Service_Principal_Name",
    "f3a64788-5306-11d1-a9c5-0000f80367c1": "Validated_Write_to_Service_Principal_Name",
    "9b026da6-0d3c-465c-8bee-5199d7165cba": "DS_Replication_Get_Changes_All_with_a_Filter",
    "3f78c3e5-f79a-46bd-a0b8-9d18116ddc79": "Add_GUID",
    "e362ed86-b728-0842-b27d-2dea7a9df218": "Access_Control_Assistance_Operators",
    "e48d0154-bcf8-11d1-8702-00c04fb96050": "DS_Replication_Manage_Topology",
    "bf967aa8-0de6-11d0-a285-00aa003049e2": "Read",
    "037088f8-0ae1-11d2-b422-00a0c968f939": "Account_Restrictions",
    "6db69a1c-9422-11d1-aebd-0000f80367c1": "DS_Replication_Get_Changes_In_Filtered_Set_with_a_Filter",
    "3e0abfd0-126a-11d0-a060-00aa006c33ed": "DS_Install_Replica",
    "1a60ea8d-58a6-4b20-bcdc-fb71eb8a9ff8": "Reload_SSL_Certificate",
    "7726b9d5-a4b4-4288-a6b2-dce952e80a7f": "Run_Protect_Admin_Groups_Task",
    "440820ad-65b4-11d1-a3da-0000f875ae0d": "Add_GUID",
    "1abd7cf8-0a99-11d1-adbb-00c04fd8d5cd": "Allocate_Rids",
    "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2": "DS_Replication_Get_Changes",
    "89e95b76-444d-4c62-991a-0facbeda640c": "DS_Replication_Get_Changes_In_Filtered_Set"
}

write_groups = [
    "RAS and IAS Servers"]

default_remote_login_groups = [
    "Domain Admins",
    "Enterprise Admins",
    "Administrators",
    "Remote Desktop Users",
    "Distributed COM Users",
    "DnsAdmins",
    "Group Policy Creator Owners",
    "Print Operators",
    "Server Operators",
    "Backup Operators",
    "Cryptographic Operators",
    "Network Configuration Operators",
    "Power Users",
    "Remote Management Users",
    "Remote Desktop Users",
    "TelnetClients",
    "Performance Log Users",
    "Performance Monitor Users",
    "Service Accounts",
    "Interactive"
]


def rank_permissions(permission_list: list):
    first_number = permission_ranking[permission_list[0].upper().replace(" ", "_")]
    first_permission = permission_list[0]
    for permission in permission_list:
        permission = permission.upper().replace(' ', '_')
        p = permission_ranking[permission]
        if p > first_number:
            first_number = p
            first_permission = permission
    return first_permission



Nonhex_PERMISSIONS = {
    "GA": "GENERIC ALL",
    "GR": "GENERIC READ",
    "GW": "GENERIC WRITE",
    "GX": "GENERIC EXECUTE",
    "RC": "Read Permissions",
    "SD": "Delete",
    "WD": "Modify Permissions",
    "WO": "Modify Owner",
    "RP": "Read All Properties",
    "WP": "Write All Properties",
    "CC": "Create All Child Objects",
    "DC": "Delete All Child Objects",
    "LC": "List Contents",
    "SW": "All Validated Writes",
    "LO": "List Object",
    "DT": "Delete Subtree",
    "CR": "All Extended Rights",
    "FA": "FILE ALL ACCESS",
    "FR": "FILE GENERIC READ",
    "FW": "FILE GENERIC WRITE",
    "FX": "FILE GENERIC EXECUTE",
    "KA": "KEY ALL ACCESS",
    "KR": "KEY READ",
    "KW": "KEY WRITE",
    "KX": "KEY EXECUTE",
    "0x0004": "KEY CREATE SUB KEYS",
    "0x0008": "KEY ENUMERATE SUB KEYS",
    "0x0010": "KEY NOTIFY",
    "0x0001": "KEY QUERY VALUE",
    "0x0002": "KEY SET VALUE"
}
TRUSTEES={
    "AO": "Account operators",
    "RU": "Alias to allow previous Windows 2000",
    "AN": "Anonymous logon",
    "AU": "Authenticated users",
    "BA": "Built-in administrators",
    "BG": "Built-in guests",
    "BO": "Backup operators",
    "BU": "Built-in users",
    "CA": "Certificate server administrators",
    "CG": "Creator group",
    "CO": "Creator owner",
    "DA": "Domain administrators",
    "DC": "Domain computers",
    "DD": "Domain controllers",
    "DG": "Domain guests",
    "DU": "Domain users",
    "EA": "Enterprise administrators",
    "ED": "Enterprise domain controllers",
    "WD": "Everyone",
    "PA": "Group Policy administrators",
    "IU": "Interactively logged-on user",
    "LA": "Local administrator",
    "LG": "Local guest",
    "LS": "Local service account",
    "SY": "Local system",
    "NU": "Network logon user",
    "NO": "Network configuration operators",
    "NS": "Network service account",
    "PO": "Printer operators",
    "PS": "Personal self",
    "PU": "Power users",
    "RS": "RAS servers group",
    "RD": "Terminal server users",
    "RE": "Replicator",
    "RC": "Restricted code",
    "SA": "Schema administrators",
    "SO": "Server operators",
    "SU": "Service logon user"

}